<!DOCTYPE html>
<html>
    <head>
        <title>Krum - Charisius Library Documentation</title>
        <link rel="stylesheet" type="text/css" href="styles.css">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
    </head>
    <body>
        <script>hljs.highlightAll();</script>
        <div class="container">
            <div class="sidebar">
                <!-- Start of Sidebar -->
                <h2>Documentation</h2>
                <ul>
                    <li><a href="getting_started.html">Getting Started</a></li>
                    <li><a href="krum.html">Krum</a></li>
                    <li><a href="multi_krum.html">Multi Krum</a></li>
                    <li><a href="nnm.html">Nearest-Neighbor-Mixing</a></li>
                    <li><a href="gm.html">Geometric Median</a></li>
                    <li><a href="bucketing.html">Bucketing</a></li>
                    <li><a href="cc.html">Centered-Clipping</a></li>
                    <li><a href="monna.html">MoNNA</a></li>
                    <li><a href="https://www.serhanyilmaz.org/Project-Charisius/">Back to Main Page</a></li>
                    <!-- Add more functions as required -->
                </ul>
                <!-- End of Sidebar -->
            </div>

            <div class="content">
                <!-- Start of Main Content Area -->
                <h2>Nearest Neighbor Mixing Function</h2>
                <p>Here's how to use the Nearest Neighbor Mixing function:</p>

                <pre><code class="language-python">
                # Import the library
                import charisius

                # Initialize aggregator and vectors
                aggregator = ...
                vectors = [...]

                # Call nearest_neighbor_mixing function
                result_old = charisius.nearest_neighbor_mixing_old(aggregator, vectors)
                result_new = charisius.nearest_neighbor_mixing(aggregator, vectors)
                </code></pre>

                <br>

                <h3>Inputs</h3>
                <ul>
                    <li><code>aggregator</code>: object - The aggregator object containing the 'nb_byz' property.</li>
                    <li><code>vectors</code>: list - The list of PyTorch Tensors to be processed.</li>
                </ul>

                <br>

                <h3>Outputs</h3>
                <ul>
                    <li><code>result_old, result_new</code>: torch.Tensor - The processed vectors after applying the nearest neighbor mixing function.</li>
                </ul>


                <br>
                <br>

                <h3>Performance Improvement</h3>
                <p>We have performed several benchmarks to show the improvement in performance of the new Krum function over the old one. Here are the results:</p>

                <!-- You can add a table with benchmark results here -->
                <table>
                    <thead>
                        <tr>
                            <th>Test Case</th>
                            <th>Old Function Time</th>
                            <th>New Function Time</th>
                            <th>Improvement (x)</th>
                            <th>Improvement (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>SF</td>
                            <td>1.00s</td>
                            <td>0.45s</td>
                            <td>2.20x</td>
                            <td>119.87%</td>
                        </tr>
                        <tr>
                            <td>LF</td>
                            <td>1.00s</td>
                            <td>0.43s</td>
                            <td>2.32x</td>
                            <td>132.35%</td>
                        </tr>
                        <tr>
                            <td>FOE</td>
                            <td>1.00s</td>
                            <td>0.47s</td>
                            <td>2.14x</td>
                            <td>114.12%</td>
                        </tr>
                        <tr>
                            <td>ALIE</td>
                            <td>1.00s</td>
                            <td>0.47s</td>
                            <td>2.12x</td>
                            <td>112.08%</td>
                        </tr>
                        <tr>
                            <td>mimic</td>
                            <td>1.00s</td>
                            <td>0.46s</td>
                            <td>2.17x</td>
                            <td>117.09%</td>
                        </tr>
                        <tr>
                            <td>auto_ALIE</td>
                            <td>1.00s</td>
                            <td>0.42s</td>
                            <td>2.36x</td>
                            <td>136.33%</td>
                        </tr>
                        <tr>
                            <td>auto_FOE</td>
                            <td>1.00s</td>
                            <td>0.42s</td>
                            <td>2.36x</td>
                            <td>135.87%</td>
                        </tr>
                        <tr>
                            <td>inf</td>
                            <td>1.00s</td>
                            <td>0.45s</td>
                            <td>2.21x</td>
                            <td>121.14%</td>
                        </tr>
                    </tbody>
                </table>
                
                <!-- Dropdown to select a test case -->
                <select id="testcase-select">
                    <option value="sf">SF</option>
                    <option value="lf">LF</option>
                    <option value="foe">FOE</option>
                    <option value="alie">ALIE</option>
                    <option value="mimic">mimic</option>
                    <option value="auto_alie">auto_ALIE</option>
                    <option value="auto_foe">auto_FOE</option>
                    <option value="inf">inf</option>
                </select>
                
                <!-- Canvas to contain the graph -->
                <canvas id="performance-chart" width="800" height="400"></canvas>
                
                <!-- JavaScript to draw and update the graph -->
                <script>
                var allData = {
                    sf: {
                        labels: ["SF"],
                        datasets: [
                            {
                                label: "Old Function Time",
                                data: [1.00],
                                backgroundColor: "rgba(255, 99, 132, 0.2)"
                            },
                            {
                                label: "New Function Time",
                                data: [0.45],
                                backgroundColor: "rgba(54, 162, 235, 0.2)"
                            }
                        ]
                    },
                    lf: {
                        labels: ["LF"],
                        datasets: [
                            {
                                label: "Old Function Time",
                                data: [1.00],
                                backgroundColor: "rgba(255, 99, 132, 0.2)"
                            },
                            {
                                label: "New Function Time",
                                data: [0.43],
                                backgroundColor: "rgba(54, 162, 235, 0.2)"
                            }
                        ]
                    },
                    foe: {
                        labels: ["FOE"],
                        datasets: [
                            {
                                label: "Old Function Time",
                                data: [1.00],
                                backgroundColor: "rgba(255, 99, 132, 0.2)"
                            },
                            {
                                label: "New Function Time",
                                data: [0.47],
                                backgroundColor: "rgba(54, 162, 235, 0.2)"
                            }
                        ]
                    },
                    alie: {
                        labels: ["ALIE"],
                        datasets: [
                            {
                                label: "Old Function Time",
                                data: [1.00],
                                backgroundColor: "rgba(255, 99, 132, 0.2)"
                            },
                            {
                                label: "New Function Time",
                                data: [0.47],
                                backgroundColor: "rgba(54, 162, 235, 0.2)"
                            }
                        ]
                    },
                    mimic: {
                        labels: ["mimic"],
                        datasets: [
                            {
                                label: "Old Function Time",
                                data: [1.00],
                                backgroundColor: "rgba(255, 99, 132, 0.2)"
                            },
                            {
                                label: "New Function Time",
                                data: [0.46],
                                backgroundColor: "rgba(54, 162, 235, 0.2)"
                            }
                        ]
                    },
                    auto_alie: {
                        labels: ["auto_ALIE"],
                        datasets: [
                            {
                                label: "Old Function Time",
                                data: [1.00],
                                backgroundColor: "rgba(255, 99, 132, 0.2)"
                            },
                            {
                                label: "New Function Time",
                                data: [0.42],
                                backgroundColor: "rgba(54, 162, 235, 0.2)"
                            }
                        ]
                    },
                    auto_foe: {
                        labels: ["auto_FOE"],
                        datasets: [
                            {
                                label: "Old Function Time",
                                data: [1.00],
                                backgroundColor: "rgba(255, 99, 132, 0.2)"
                            },
                            {
                                label: "New Function Time",
                                data: [0.42],
                                backgroundColor: "rgba(54, 162, 235, 0.2)"
                            }
                        ]
                    },
                    inf: {
                        labels: ["inf"],
                        datasets: [
                            {
                                label: "Old Function Time",
                                data: [1.00],
                                backgroundColor: "rgba(255, 99, 132, 0.2)"
                            },
                            {
                                label: "New Function Time",
                                data: [0.45],
                                backgroundColor: "rgba(54, 162, 235, 0.2)"
                            }
                        ]
                    }
                };

                var ctx = document.getElementById("performance-chart").getContext("2d");
                var myChart = new Chart(ctx, {
                    type: "bar",
                    data: allData.testcase1, 
                    options: {
                        responsive: true,
                        scales: {
                            xAxes: [{
                                display: true,
                                scaleLabel: {
                                    display: true
                                }
                            }],
                            yAxes: [{
                                display: true,
                                ticks: {
                                    beginAtZero: true
                                }
                            }]
                        }
                    }
                });

                document.getElementById('testcase-select').addEventListener('change', function() {
                    var selectedTestcase = this.value;

                    myChart.data = allData[selectedTestcase];
                    myChart.update();
                });
                </script>

                <!-- Navigation -->
                <div class="navigation">
                    <a href="multi_krum.html" class="prev">Previous</a>
                    <a href="gm.html" class="next">Next</a>
                </div>
            </div>
        </div>
    </body>
</html>
